%{
#include <linux/security.h>
#include <linux/sched.h>
%}

function sid_to_context_str:string (sid:long)%{
	/*return the pointer to */
	char * ret;
	int len;
	/*bug to fix: memory leak */
	security_secid_to_secctx((int) THIS->sid, &ret, &len);
	snprintf(THIS->__retvalue, MAXSTRINGLEN, "%s", ret);
	kfree(ret);
%}

function pid_to_sid:long (pid: long)%{
	/*task pointer to current val*/
	struct task_struct * tp;
	pid_t pid = (pid_t) THIS->pid;
	int sid;
	tp = find_task_by_vpid(pid);
	sid = security_task_getsid(tp);
	THIS->__retvalue = (long) sid;
%}

