%{
#include <linux/security.h>
%}

function sid_to_context_str:string (sid:long)%{
	/*return the pointer to */
	char * ret;
	int len;
	/*bug to fix: memory leak */
	security_secid_to_secctx((int) THIS->sid, &ret, &len);
	snprintf(THIS->__retvalue, MAXSTRINGLEN, "%s", ret);
	kfree(ret);
%}

function pid2sid:long (pid:long) %{
	 THIS->__retvalue = (long) security_task_getsid((struct task_struct *)pid2task(THIS->pid));
%}
